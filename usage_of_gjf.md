## Gaussian インプットファイル (.gjf) の基本構造

Gaussian インプットファイルは、基本的に以下のセクションで構成されています。

- **Link 0 (リンク 0) コマンド**: 計算リソース（メモリ、プロセッサ）の割り当て、チェックポイントファイルの指定など。`%Mem`, `%NProcShared`, `%Chk` など。
- **Route Section (ルートセクション)**: 計算の種類、モデル化学、キーワード、オプションなど。`#` で始まる行。
- **Title Section (タイトルセクション)**: 計算の簡単な説明。必須ではありませんが、推奨されます。空行で区切られます。
- **Molecule Specification (分子指定セクション)**: 分子の電荷、スピン多重度、原子の座標。空行で区切られます。
- **Additional Input (追加のインプット)**: 追加のデータ（例：フロンティア軌道の指定、外部電場など）。計算の種類によって必要になります。空行で区切られます。

各セクションは空行で区切る必要があります。ファイル全体は、最後のセクションの後に空行で終わる必要があります。

---

## 各セクションの詳細とコマンドの種類

### 1\. Link 0 (リンク 0) コマンド

計算の実行環境を設定します。ファイルの先頭に記述します。

- `%Chk=ファイル名.chk`: チェックポイントファイルのパスと名前を指定します。計算が中断した場合に再開したり、後続の計算に利用したりできます。
  - 例: `%Chk=my_calculation.chk`
- `%Mem=メモリ量`: Gaussian が使用するメモリ量を指定します。単位は通常、MB（メガバイト）です。
  - 例: `%Mem=4GB` (または `%Mem=4000MB`)
- `%NProcShared=CPU数`: 共有メモリ並列計算に使用する CPU コア数を指定します。
  - 例: `%NProcShared=8`
- `%NoSave`: チェックポイントファイルを保存しない場合に指定します。
- `%Save`: チェックポイントファイルを明示的に保存する場合に指定します (デフォルトで保存されますが、明示的に指定することもあります)。

### 2\. Route Section (ルートセクション)

計算の種類、モデル化学、および追加のオプションを定義します。常に`#`で始まります。複数のキーワードをスペースで区切って記述できます。

#### 主要な計算タイプ (キーワード)

- **エネルギー計算**:
  - `SP`: 単一点エネルギー計算。特定の分子構造のエネルギーを計算します。
    - 例: `# B3LYP/6-31G(d) SP`
- **構造最適化**:
  - `Opt`: 分子の平衡構造を見つけます。
    - 例: `# B3LYP/6-31G(d) Opt`
  - **サブオプション**:
    - `Opt=Loose`, `Opt=Tight`, `Opt=VeryTight`: 収束基準の厳しさを指定します。
    - `Opt=Freq`: 最適化後、振動数計算も行います（局所的極小値であることを確認するため）。
    - `Opt=TS`: 遷移状態の最適化。
    - `Opt=QST2`, `Opt=QST3`: 遷移状態探索の初期構造指定方法。
- **振動数計算 (Frequency Calculation)**:
  - `Freq`: 基準振動、IR、Raman スペクトル、熱力学的量（エンタルピー、エントロピー、ギブズ自由エネルギー）を計算します。
    - 例: `# B3LYP/6-31G(d) Freq`
  - **重要**: `Freq`計算は、常に平衡構造（局所的極小値）で行われるべきです。そうでない場合、虚の振動数が検出されます。
- **遷移状態計算 (Transition State Calculation)**:
  - `Opt=TS`: 遷移状態の構造を最適化します。
  - `IRC`: 固有反応座標 (Intrinsic Reaction Coordinate) をたどり、反応経路を確認します。
- **NMR スペクトル計算**:
  - `NMR`: NMR シールド定数と結合定数を計算します。
    - 例: `# B3LYP/6-31G(d) NMR`
- **TD-DFT (Time-Dependent DFT)**:
  - `TD`: 電子励起状態と UV/Vis スペクトルを計算します。
    - 例: `# B3LYP/6-31G(d) TD(NStates=5)` (最初の 5 つの励起状態を計算)
- **電荷分布解析**:
  - `Pop=Mulliken`, `Pop=NBO`, `Pop=Hirshfeld`: さまざまな電荷解析を行います。
    - 例: `# B3LYP/6-31G(d) SP Pop=NBO`

#### モデル化学 (Model Chemistry)

使用する理論レベルと基底関数を指定します。

- **Hartree-Fock (HF)**:
  - `HF`: 最も基本的な電子相関を考慮しない方法。
    - 例: `# HF/6-31G(d) Opt`
- **密度汎関数理論 (DFT)**:
  - `B3LYP`: 最も広く使用されているハイブリッド汎関数。
  - `PBEPBE`, `TPSS`, `M06-2X`, `wB97XD` など、多くの汎関数があります。
    - 例: `# B3LYP/6-31G(d) SP`
- **ポスト HF 法**:
  - `MP2`: 2 次のメラー・プレセット摂動法。
  - `CCSD`, `CCSD(T)`: 結合クラスター法。高精度だが計算コストが高い。
    - 例: `# MP2/6-31G(d) SP`

#### 基底関数系 (Basis Set)

原子軌道を記述するために使用される数学的な関数セット。

- **Pople 型の基底関数**:
  - `STO-3G`, `3-21G`, `6-31G`, `6-31G(d)`, `6-31G(d,p)`, `6-311+G(2df,p)` など。
  - `(d)` または `*`: 重原子上の分極関数。
  - `(p)` または `**`: 水素原子上の分極関数。
  - `+`: 拡散関数（アニオン、水素結合、ファンデルワールス力などの記述に重要）。
  - `++`: 重原子と水素原子の両方に拡散関数。
- **Dunning 型の相関コンシステント基底関数**:
  - `cc-pVDZ`, `cc-pVTZ`, `aug-cc-pVDZ` など。
  - `aug-`: 拡散関数を追加。
- **有効内殻ポテンシャル (ECP) 基底関数**:
  - `LANL2DZ`: 重原子に ECP を使用する場合。
    - 例: `# B3LYP/LANL2DZ Opt` (重原子に`LANL2DZ`、軽原子に`6-31G(d)`を併用することも可能)

#### その他の重要なキーワードとオプション

- `SCF=(Tight, MaxCyc=200)`: SCF 収束基準の厳しさや最大繰り返し回数を設定します。
- `Geom=AllCheck`: チェックポイントファイルから全ての分子情報を読み込みます。
- `Geom=Check`: チェックポイントファイルから座標を読み込みます。
- `IOp(Key1/Val1, Key2/Val2, ...)`: 低レベルの Gaussian オプションを設定します。通常は経験豊富なユーザーが使用します。
- `Guess=Mix`: 初期軌道を混合して、SCF 収束を助けます。
- `NoSymmetry`: 分子対称性を利用しないように指示します（まれに使用）。
- `Polar`: 分極率と超分極率を計算します。
- `SCRF=PCM`: 溶媒効果を考慮した計算（極性化連続体モデル）。
  - **サブオプション**: `Solvent=Water`, `Solvent=Ethanol` など。
    - 例: `# B3LYP/6-31G(d) Opt SCRF=(PCM, Solvent=Water)`
- `Integral=Grid=FineGrid`: 積分グリッドの密度を高くします（より正確だが計算コスト増）。

### 3\. Title Section (タイトルセクション)

計算の目的や簡単な説明を記述します。どのような内容でも構いませんが、将来的に計算内容を特定できるような記述が望ましいです。このセクションは 1 行以上で、空行で終了します。

### 4\. Molecule Specification (分子指定セクション)

分子の電荷、スピン多重度、および原子座標を記述します。

#### 電荷とスピン多重度

1 行目に記述します。

`電荷 スピン多重度`

- **電荷**: 分子の総電荷（例: 中性分子は`0`、カチオンは`1`、アニオンは`-1`）。
- **スピン多重度**: $(2S+1)$ で表されます。$S$は全スピン量子数。
  - 一重項 (全ての電子が対になっている): $S=0$, 多重度$=1$
  - 二重項 (不対電子が 1 つ): $S=1/2$, 多重度$=2$
  - 三重項 (不対電子が 2 つ): $S=1$, 多重度$=3$
  - 例: `0 1` (中性一重項分子)
  - 例: `1 2` (電荷+1 の二重項分子)

#### 原子座標

##### Z-Matrix 形式:

原子間の結合距離、結合角、二面角で分子構造を記述します。対称性が高く、特定の結合や角度を固定したい場合に便利です。

書式:

```
原子1
原子2 結合1 距離1
原子3 結合2 距離2 結合3 角度1
原子4 結合4 距離3 結合5 角度2 結合6 二面角1
```

- `結合X` は、その原子が結合している前の行で定義された原子の番号です。

変数を使用することもできます:

```
H
O 1 R1
H 2 R2 1 A1

Variables:
R1=0.96
R2=0.96
A1=104.5
```

##### Cartesian 座標形式:

各原子の X, Y, Z 座標で記述します。他のソフトウェアから座標をコピー＆ペーストするのに便利です。

書式:

```
原子タイプ X Y Z
```

例:

```
0 1
Title Section

O  0.000000  0.000000  0.117600
H  0.757000  0.000000 -0.470400
H -0.757000  0.000000 -0.470400
```

### 5\. Additional Input (追加のインプット)

特定の計算や解析のために追加のデータを記述するセクションです。このセクションは、Route Section のキーワードに依存します。

- **分子軌道 (MO) の指定**:
  - `Guess=Read` と併用し、特定の軌道を読み込む場合。
  - 例:
    ```
    $MoRead
    ... (MO係数) ...
    $End
    ```
- **ECP (Effective Core Potential) の指定**:
  - カスタム ECP を使用する場合。
- **IRC 計算のステップサイズ**:
  - `IRC=RCFC` のように指定する場合。

---

## .gjf ファイル作成の一般的なワークフロー

1.  **分子構造の準備**: ChemDraw, GaussView, Avogadro などの分子モデリングソフトウェアを使用して、初期分子構造を作成します。
2.  **インプットファイルの生成**: 分子モデリングソフトウェアから.gjf ファイルをエクスポートするか、テキストエディタで手動で作成します。
3.  **Route Section の編集**: 必要な計算タイプ、モデル化学、基底関数、オプションを適切に設定します。
4.  **Link 0 コマンドの追加**: メモリ、CPU、チェックポイントファイルの設定を行います。
5.  **Title Section の記述**: 計算内容がわかるように記述します。
6.  **Molecule Specification の確認**: 電荷とスピン多重度が正しいか、座標が正しいかを確認します。
7.  **保存**: **.gjf** または **.com** 拡張子で保存します。

---

## 例：水分子の B3LYP/6-31G(d)での最適化と振動数計算

```
%Chk=water_opt_freq.chk
%Mem=2GB
%NProcShared=4
# B3LYP/6-31G(d) Opt Freq

Water molecule optimization and frequency calculation

0 1
O  0.000000  0.000000  0.117600
H  0.757000  0.000000 -0.470400
H -0.757000  0.000000 -0.470400
```
